#+TITLE: Emacs操作汇总
#+AUTHOR: hdc(simpleotter23@gmail.com)
#+EMAIL: simpleotter23@gmail.com
#+DATE: 2013/12/29
#+STARTUP: indent

* Emacs命令
** 基本命令
| 快捷键  | 命令 | 说明                                         |
|---------+------+----------------------------------------------|
| C-x C-c |      | 退出Emacs                                    |
| C-x C-f |      | 打开一个文件，如果文件不存在，则创建一个文件 |
| C-x d   |      | 进入 Dired 列表模式                          |
| C-x C-d |      | 获取文件列表（简洁）                         |
| C-g     |      | 取消未完成的命令                             |
** 编辑命令
| 快捷键  | 命令 | 说明                                                                                 |
|---------+------+--------------------------------------------------------------------------------------|
| C-x u   |      | 取消上一次操作，如果取消N次操作：C-u N C-_                                           |
| C-x i   |      | 插入文件内容                                                                         |
| C-t     |      | 交换两个字符                                                                         |
| M-t     |      | 交换两个词                                                                           |
| C-x C-t |      | 交换两行                                                                             |
| C-x C-u |      | 转换成大写字母                                                                       |
| C-x C-l |      | 转换成小写字母                                                                       |
| M-c     |      | 把光标右边的单词的首字母转换为大写，如果光标在一个单词内，则把光标所在字母转换为大写 |
| M-u     |      | 把光标右边的单词转换为大写，如果光标在一个单词内，则把这个单词右边的部分转换为大写   |
| M-l     |      | 转换成小写字母                                                                       |
| C-c C-a |      | 开启/关闭自动缩进模式，如同 M-x c-toggle-auto-state                                  |
**  移动光标
| 快捷键     | 命令 | 说明                                              |
|------------+------+---------------------------------------------------|
| C-v        |      | 向前翻页                                          |
| M-v        |      | 向后翻页                                          |
| M-r        |      | 将光标移动到屏幕中间那行                          |
| C-a        |      | 移到行首                                          |
| C-e        |      | 移到行尾                                          |
| M-a        |      | 移到句首                                          |
| M-e        |      | 移到句尾                                          |
| M-{        |      | 向上移动一段                                      |
| M-}        |      | 向下移动一段                                      |
| M-<        |      | 移到整个文本开头                                  |
| M->        |      | 移到整个文本末尾                                  |
| C-p        |      | 向上移动一行，p 代表 previous                     |
| C-n        |      | 向下移动一行，n 代表 next                         |
| C-f        |      | 向前移动一个字，f 代表 forward                    |
| C-b        |      | 向后移动一个字，b 代表 back                       |
| C-u        |      | 数字 命令：执行多次{数字表示次数}该命令           |
| C-l        |      | 重绘屏幕，效果就是当前编辑行移动窗口中央，刷新    |
| C-M-\      |      | 用C-x h选定整个buff后，然后可以对代码进行重新排版 |
| M-;        |      | 对当前行进行注释                                  |
| C-x C-x    |      | 快速返回移动前的光标位置                          |
| C-c C-c    |      | 对一块代码进行注释                                |
** Buffer相关
| 快捷键                | 命令 | 说明                                                                                         |
|-----------------------+------+----------------------------------------------------------------------------------------------|
| C-x h                 |      | 选中整个缓冲区的内容，您会发现状态栏和编辑器底部之间的区域出现 Mark set 字样                 |
| C-x k                 |      | 关闭当前buffer                                                                               |
| C-x b                 |      | 切换到前一个编辑的buffer                                                                     |
| C-x C-b               |      | 列出当前所有的buffer                                                                         |
| C-x C-s               |      | 保存当前buffer                                                                               |
| C-x C-w               |      | 文件另存为                                                                                   |
| C-mouse               |      | 按住 Ctrl 并单击鼠标左键，会弹出一个 Buffer Menu，它会按主模式类型列出活动的 buffer 供你选择 |
| M-x kill-some-buffers |      | 删除一些buffer                                                                               |
** 拷贝与粘贴
| 快捷键     | 命令 | 说明                                                                                                          |
|------------+------+---------------------------------------------------------------------------------------------------------------|
| C-@        |      | 设置mark，或使用 M-x set-mark-command                                                                         |
| C-w        |      | 剪切一块区域，如果没有设置mark，则是剪切一行                                                                  |
| M-w        |      | 拷贝一块区域，如果没有设置mark，则是拷贝一行                                                                  |
| M-d        |      | 删除光标后的词语                                                                                              |
| M-Backspce |      | 删除光标前的词语                                                                                              |
| C-d        |      | 删除一个字符                                                                                                  |
| C-k        |      | 从当前位置剪切到行尾                                                                                          |
| C-y        |      | 粘贴                                                                                                          |
| M-y        |      | 用 C-y 拉回最近被除去的文本后，换成 M-y 可以拉回以前被除去的文本。键入多次的 M-y 可以拉回更早以前被除去的文本 |
| C-x r k    |      | 执行矩形区域的剪切                                                                                            |
| C-x r y    |      | 执行矩形区域的粘贴                                                                                            |
| C-x h      |      | 全部选中                                                                                                      |
| C-o        |      | 在光标后面插入空行                                                                                            |
| C-x C-o    |      | 将光标附近的空行去掉，多行的时候，第一次只剩一行，第二次全部删除                                              |
** 窗口操作
| 快捷键      | 命令 | 说明                                                                                                     |
|-------------+------+----------------------------------------------------------------------------------------------------------|
| C-x 0       |      | 关闭当前窗口                                                                                             |
| C-x 1       |      | 将当前窗口最大化                                                                                         |
| C-x 2       |      | 垂直分割窗口                                                                                             |
| C-x 3       |      | 水平分割窗口                                                                                             |
| C-x <       |      | 窗口内容右卷                                                                                             |
| C-x >       |      | 窗口内容左卷（这两个命令在垂直分割窗口后比较有用）                                                       |
| (C-u) C-x ^ |      | 加高当前窗口，如果有 C-u，则每次加高 4 行                                                                |
| (C-u) C-x } |      | 加宽当前窗口                                                                                             |
| (C-u) C-x { |      | 压窄当前窗口                                                                                             |
| ESC C-v     |      | 在其它窗口进行卷屏操作                                                                                   |
| C-M-v       |      | 滚动另一个窗口（C-v是滚动当前窗口）                                                                      |
| C-x 4 b(f)  |      | 在另一个窗口选择另一个buffer（查找另一个文件），这样你可以不用切换到另一个窗口，就改变其buffer或打开文件 |
| C-x 5 2     |      | 新建一个 frame                                                                                               | 
** 搜索和替换
| 快捷键             | 命令 | 说明                                                    |
|--------------------+------+---------------------------------------------------------|
| C-s                |      | 向前搜索（增量式搜索）；连续C-s，跳到下一个搜索到的目标 |
| C-s RET            |      | 普通搜索                                                |
| C-r                |      | 向前搜索                                                |
| C-s RET C-w        |      | 按单词查询                                              |
| M-%                |      | 查询替换，也就是替换前会询问一下                        |
| M-x replace-string |      | 普通替换                                                    | 
** 命令执行命令
由于 Emacs 太过强大，内部命令恒河沙数，根本不可能有同样数量的快捷键位来绑定它们！
对于没有绑定的命令，可以使用命令行执行！
| 快捷键             | 命令 | 说明                                                     |
|--------------------+------+----------------------------------------------------------|
| M-x                |      | 开启命令行，回显区显示为 M-x                             |
| M-x goto-line      |      | 移动到某一行                                             |
| M-x replace-string |      | 普通替换                                                 |
| M-x replace-regexp |      | 正则表达式替换                                           |
| M-x undo           |      | 撤销                                                     |
| C-g M-x undo       |      | 重做                                                     |
| M-x query-replace  |      | 询问替换，等赋于 C-%                                     |
| M-x calendar       |      | 打开日历，q 退出，C-u，M-x calendar 打开指定的年，月，日 |
| C-f                |      | 让当前日期向前一天                                       |
| C-b                |      | 让当前日期向后一天                                       |
| C-n                |      | 让当前日期向前一周                                       |
| C-p                |      | 让当前日期向后一周                                       |
| M-}                |      | 让当前日期向前一个月                                     |
| M-{                |      | 让当前日期向后一个月                                     |
| C-x ]              |      | 让当前日期向前一年                                       |
| C-x [              |      | 让当前日期向后一年                                       |
| C-a                |      | 移动到当前周的第一天                                     |
| C-e                |      | 移动到当前周的最后一天                                   |
| M-a                |      | 移动到当前月的第一天                                     |
| M-e                |      | 移动到当前月的最后一天                                   |
| M-<                |      | 移动到当前年的第一天                                     |
| M->                |      | 移动到当前年的最后一天                                              |

* org-mode介绍
  简单来说，org-mode就是一个记录笔记，todolist，管理时刻表等等的东西。

* org-mode 使用
  用*，**，***来区分各级标题，1.2.或者+、-来更细化，用过lateX的应该一下就明白这样安排的特点了。
然后TODO是记录要做的事情。在*处按shift+右键切换状态。

* 用大纲组织内容
  尽管org-mode的功能不断丰富，现在已经可以记笔记，管理个人事务，制定项目计划以及很多其他的用途，
但是最初和最基本的功能还是通过大纲（outline）的方式来编辑文档。而且，无论是笔记管理，任务管理还是
项目计划的编写，都是以对内容进行高效的组织（organization）为基础的。

在编辑文档，尤其是大型文档的时候，对内容的组织就显得尤为重要。经常需要在文档中快速定位，只关注某一部分
的内容，Word之类的编辑器，通过文档的结构图来定位文档的位置，速度很慢，而且很多时候不能满足编辑的需要。
尽管Word也提供了“大纲视图”，但是，唉……不说也罢，如果那个功能真的好用，也就不需要Omni Outliner了。

Org-mode天然支持大纲视图，通过在文档中定义标题，可以方便的浏览每个小节，从而把握文档的总体内容。
Org是基于Outline模式的，它提供了更灵活的编辑结构文件的命令。比如折叠文档，针对大纲的编辑功能等，
极其强大。

** 定义标题
  要实现大纲，首先要定义标题，用Emacs新建一个orgmode.org，输入如下内容：
#+BEGIN_EXAMPLE
* org-mode
** 大纲
正在编写大纲
** 轻量级标记语言
* 可以导出其他格式
支持html，pdf等格式
#+END_EXAMPLE

*注意：*
1. * 要位于每行的行首
2. * 之后要有一个空格，然后再输入标题
3. 连续几个 * 就表示是第几级大纲，最多支持10级

   此时看起来应该是这个样子：

   [[file:2012041223295589.png]]

   觉得没什么出奇的地方，只是改变了一些颜色？其真正的用处在于可以通过大纲操作文档，包括折叠，
定位和编辑。而这些操作都通过快捷键实现，非常有效率。尤其是对大文档。

** 大纲相关的快捷键
*** 折叠大纲
   | 快捷键 | 命令         | 说明                                                               |
   |--------+--------------+--------------------------------------------------------------------|
   | S-TAB  | org-shifttab | 循环切换整个文档的大纲状态（三种状态：折叠，打开下一级，打开全部） |
   | TAB    | org-cycle    | 循环切换光标所在大纲的状态                                                      |

*** 大大纲之间移动
    | 快捷键    | 命令 | 说明                        |
    |-----------+------+-----------------------------|
    | C-c C-n/p |      | 上/下一标题                 |
    | C-c C-f/b |      | 下/上一标题（仅限同级标题） |
    | C-c C-u   |      | 跳到一上级标题              |
    | C-c C-j   |      | 切换到大纲浏览状态                   |

*** 基于大纲的编辑
    | 快捷键         | 命令 | 说明                                       |
    |----------------+------+--------------------------------------------|
    | M-RET          |      | 插入一个同级标题                           |
    | M-S-RET        |      | 插入一个同级TDDO标题                       |
    | M-LEFT/RIGHT   |      | 将当前标题升/降级                          |
    | M-S-LEFT/RIGHT |      | 将子树升/降级                              |
    | M-S-UP/DOWN    |      | 将子树上/下移                              |
    | C-c *          |      | 将本行设为标题/正文                        |
    | C-c C-w        |      | 将子树或区域移动到另一个标题处（跨缓冲区） |
    | C-x n s/w      |      | 只显示当前子树/返回                        |
    | C-c C-x b      |      | 在新缓冲区显示当前分支（类似C-x n s）      |
    | C-c /          |      | 只列出包含搜索结果的大纲，并高亮，支持多种搜索方式 |
    | C-c C-c        |      | 取消高亮                                               |

	更多快捷键可以通过 C-c C-x h 查看。

** 大纲的显示方式
   默认的大纲显示没有缩进，显得有些乱。可以用 M-x org-indent-mode 切换到另一种显示方式：

   [[file:2012041223301521.png]]

如果想让某个文件默认用这种方式打开，可以在文件头部增加：
#+BEGIN_EXAMPLE
#+STARTUP: indent
#+END_EXAMPLE
如果希望打开所有org文件都默认用这种方式，可以在.emacs中配置：
#+BEGIN_SRC lisp
(setq org-startup-indented t)
#+END_SRC

* 超连接和图文混排
超链接也是组织内容的一种非常有效的方式。Org支持多种超链接。对于符合要求的图片链接，可以形成图文混排。

** 创建链接
对于符合链接规则的内容，org-mode会自动将其视为链接，包括文件、网页、邮箱、新闻组、BBDB数据库项、
IRC会话和记录等。下面是一些例子：
#+BEGIN_EXAMPLE
http://www.astro.uva.nl/~dominik            on the web
file:/home/dominik/images/jupiter.jpg       file, absolute path
/home/dominik/images/jupiter.jpg            same as above
file:papers/last.pdf                        file, relative path
file:projects.org                           another Org file
docview:papers/last.pdf::NNN                open file in doc-view mode at page NNN
id:B7423F4D-2E8A-471B-8810-C40F074717E9     Link to heading by ID
news:comp.emacs                             Usenet link
mailto:adent@galaxy.net                     Mail link
vm:folder                                   VM folder link
vm:folder#id                                VM message link
wl:folder#id                                WANDERLUST message link
mhe:folder#id                               MH-E message link
rmail:folder#id                             RMAIL message link
gnus:group#id                               Gnus article link
bbdb:R.*Stallman                            BBDB link (with regexp)
irc:/irc.com/#emacs/bob                     IRC link
info:org:External%20links                   Info node link (with encoded space)
#+END_EXAMPLE

对于文件链接，可以用::后面增加定位符的方式链接到文件的特定位置。定位符可以是行号或搜索选项。如：
#+BEGIN_EXAMPLE
file:~/code/main.c::255                     进入到 255 行
file:~/xx.org::My Target                    找到目标‘<<My Target>>’
file:~/xx.org/::#my-custom-id               查找自定义 id 的项
#+END_EXAMPLE

除了上述的自动链接外，还可以显示指定链接，采用如下格式：
#+BEGIN_EXAMPLE
[[link[description]]]
[[link]]
#+END_EXAMPLE
显示指定的链接可以不显示原始的URL而是显示对该链接的描述。这种方式可以用相对路径链接本地文件。

对于显示指定的链接，即可以手工输入，也可以用org-mode提供的快捷键进行编辑：
| 快捷键  | 命令              | 说明                                 |
|---------+-------------------+--------------------------------------|
| C-c l   |                   | 保存链接                             |
| C-c C-l | org-insert-link   | 创建或修改链接，可以引用已保存的链接 |
| C-c C-o | org-open-at-point | 打开链接                             |
| C-c %   |                   | 记录内部链接地址                     |
| C-c &   |                   | 跳转到已记录的内部链接               |
|---------+-------------------+--------------------------------------|
  
* org-mode 编辑操作
  | 快捷键    | 命令 | 说明                                                   |
  |-----------+------+--------------------------------------------------------|
  | C-c C-n   |      | 移动到下一个标题                                       |
  | C-c C-p   |      | 移动到上一个标题                                       |
  | C-c C-f   |      | 移动到和当前标题同等级的下一个标题                     |
  | C-c C-b   |      | 移动到和当前标题同等级的上一个标题                     |
  | C-c C-u   |      | 向上移动到更高一层的标题                               |
  | M-LEFT    |      | 减少节点层级                                           |
  | M-RIGHT   |      | 增加节点层级                                           |
  | M-UP      |      | 将节点向上移动                                         |
  | M-DOWN    |      | 将节点向下移动                                         |
  | M-ENTER   |      | 增加一条同级节点                                       |
  | TAB       |      | 对当前节点进行切换：收缩->查看所有子节点->查看所有内容 |
  | SHIFT-TAB |      | 对当前文件进行切换：收缩->查看所有子节点->查看所有内容 |
  | C-c .     |      | 在光标位置插入时间                                     |
  | C-c C-t   |      | 切换当前节点的状态(TODO                                |
  | C-c [     |      | 将当前文件设置为事件视力的数据源                       |
  | C-c ]     |      | 从事件视图的数据源中删除当前文件（数据源）             |

* org-mode表格操作
  Org能够很容易地处理ASCII文本表格。任何以“|”为首个非空字符的行都会被认为是表格的一部分。
  “|”也是列分隔符。一个表格是下面的样子：
#+BEGIN_EXAMPLE
  | Name  | Pone | Age |
  |-------+------+-----|
  | Peter | 1234 | 17  |
  | Anna  | 4321 | 25  |
#+END_EXAMPLE
** 创建和转换表格
  | 快捷键  | 命令 | 说明             |
  |---------+------+------------------|
  | C-c竖线 |      | 创建或转换成表格 |
** 调整和区域移动
   | 快捷键  | 命令 | 说明                           |
   |---------+------+--------------------------------|
   | C-c C-c |      | 调整表格，不移动光标           |
   | TAB     |      | 移动到下一区域，必要时新建一行 |
   | S-TAB   |      | 移动到上一区域                 |
   | RET     |      | 移动到下一行，必要时新建一行   |
** 编辑行和列
   | 快捷键         | 命令 | 说明                             |
   |----------------+------+----------------------------------|
   | M-LEFT/RIGHT   |      | 移动列                           |
   | M-UP/DOWN      |      | 移动行                           |
   | M-S-LEFT/RIGHT |      | 删除/插入列                 |
   | M-S-UP/DOWN    |      | 删除/插入行                 |
   | C-c -          |      | 添加水平分割线            |
   | C-c RET        |      | 添加水平分割线并跳到下一行 |
   | C-c ^          |      | 根据当前列排序，可能选择排序方式 |

* 段落
  对于单个回车换行的文件，认为其属于同一个段落。在导出的时候将会转化为不换行的同一段。
  如果要新起一个段落，需要留出一个空行。这点与MediaWiki类似。

* 列表
  Org能够识别有序列表、无序列表和描述列表。
  - 无序列表项以‘-’、‘+’或者‘*’开头。
  - 有序列表项以‘1.’或者‘1)’开头。
  - 描述列表用‘::’将项和描述分开。
  - 有序列表和无序列表都以缩进表示层级。只要对齐缩进，不管是换行还是分块都认为是处于当前列表项。

	同一列表中的项的第一行必须缩进相同程序。当下一行的缩进与列表项的开关的符号或者数字相同或者更
小时，这一项就结束了。当所有的项都关上时，或者后面有两个空行时，列表就结束了。例如：
#+BEGIN_EXAMPLE
My favorite scenes are (in this order)
1. The attack of the Rohirrim
2. Eowyn's flight with the witch king
   + this was already my favorite scene in the book
   + I really like Miranda Otto.
Important actors in this film are:
- Elijah Wood :: He plays Frodo
- Sean Austin :: He plays Sam, Frodo's friend.
#+END_EXAMPLE

* 一些令人赞叹的特性
  C-c C-e 可以导出成各种格式，包括自动用latex生成pdf，这个功能部分取代lyx，部分取代evernote，
取代calendar，取代todo list软件。
